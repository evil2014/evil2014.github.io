function loadImages(e,t){var n=this;var r=new createjs.LoadQueue(false);var i=[];$(e).find("element").each(function(e,t){if($(this).attr("type")=="IMAGE"){if($(this).attr("src")){i.push({id:"bitmap"+e,src:$(this).attr("src")})}}});if(i.length==0){if(t)t()}else{r.addEventListener("error",function(e){n.e()});r.addEventListener("complete",function(e){if(t)t()});r.loadManifest(i)}n.e=function(e){alert("Please check the image src")}}function drawGraphics(e){var t=new createjs.Shape;e.x=e.x?parseFloat(e.x):0;e.y=e.y?parseFloat(e.y):0;switch(e.subType){case"ARROW":i=new AComp(e);break;case"LINE":e.stroke=e.stroke?e.stroke:0;e.stokeColor=e.stokeColor?e.stokeColor:"";t.graphics.setStrokeStyle(e.stroke).beginStroke(e.stokeColor).lineTo(e.x,e.y).lineTo(e.x1,e.y1);e.x=0;e.y=0;break;case"RECT":e.stroke=e.stroke?e.stroke:0;e.stokeColor=e.stokeColor?e.stokeColor:"";e.color=e.color?e.color:"";e.corner=e.corner?e.corner:0;t.graphics.setStrokeStyle(e.stroke).beginStroke(e.stokeColor);t.graphics.beginFill(e.color).drawRoundRect(0,0,parseFloat(e.width),parseFloat(e.height),e.corner);break;case"CIRCLE":var n,r,i;n=parseFloat(e.width);r=parseFloat(e.height);i=n<r?r/2:n/2;e.stroke=e.stroke?e.stroke:0;e.stokeColor=e.stokeColor?e.stokeColor:"";e.color=e.color?e.color:"";t.graphics.setStrokeStyle(e.stroke).beginStroke(e.stokeColor);t.graphics.beginFill(e.color).drawCircle(0,0,i);if(n<r){t.scaleX=n/(i*2)}else{t.scaleY=r/(i*2)}e.x=e.x+i+5;e.y=e.y+i-15;break;default:break}if(e.rotation)t.rotation=e.rotation;t.x=e.x;t.y=e.y;return t}function getCJSElement(e,t,n){var r;switch(e){case"SINGLE":r=new slide(t,n);break;case"MBAR":r=new MBar(t);break;case"MBUTTON":break;case"IMAGE":r=new IComp(t);break;case"TEXT":t.div=n;r=new TComp(t);break;case"SHAPE":r=drawGraphics(t);break;case"ROUTER":r=new Router(t);break;case"BUBBLE":r=new BComp(t);break;case"TEXTBOX":r=new TBComp(t);break;case"BUTTON":r=new Button(t);break;default:r=new createjs.Shape;break}return r}function initiateTemplate(){canvas=document.getElementById("canvas");mStage=new createjs.Stage(canvas);if(createjs.Touch.isSupported()){createjs.Touch.enable(mStage)}mStage.enableMouseOver();var e=$(cx).find("slide")[0];if($(e).attr("width"))sWidth=$(e).attr("width");if($(e).attr("height"))sHeight=$(e).attr("height");$("#flashContent").append("<div id='mediaContainer'></div>");$("#mediaContainer").append("<div id='commonMediaText'></div>");root=new rootC;mStage.addChild(root);var t=$(e).attr("type")?$(e).attr("type"):"SINGLE";root.addChild(getCJSElement(t,e,"commonMediaText"));mStage.update();createjs.Ticker.setFPS(30);createjs.Ticker.addListener(root)}var canvas,mStage,sStage,pStage,root;var sWidth=470;var sHeight=400;(rootC=function(){this.initialize();var e=this;var t,n;var r=new createjs.Shape;r.graphics.beginFill().drawRect(0,0,sWidth,sHeight);e.addChild(r);e.tick=function(){if(window.innerWidth!=this.wW||window.innerHeight!=this.wH){this.wW=window.innerWidth;this.wH=window.innerHeight;canvas.width=this.wW*.99;canvas.height=this.wH*.99;console.log(canvas.width+"------"+this.wW);var e=Math.min(canvas.width/sWidth,canvas.height/sHeight);if(e<.9){e=.9;canvas.width=sWidth*e}else if(e>1.3){e=1.3}this.scaleX=this.scaleY=e;this.x=(canvas.width-sWidth*e)/2;this.y=(canvas.height-sHeight*e)/2;mStage.update()}};e.tick()}).prototype=new createjs.Container;(MBar=function(e){this.initialize();var t=this;var n=[];var r;t.f=function(e){if(e.target==r)return;document.body.style.cursor="pointer";e.target.r.visible=false;e.target.n.visible=true;mStage.update()};t.g=function(e){document.body.style.cursor="default";if(e.target==r)return;e.target.n.visible=false;e.target.r.visible=true;mStage.update()};t.h=function(e){if(e.target==r)return;r.n.visible=false;r.r.visible=true;n[r.a].visible=false;r=e.target;t.k();mStage.update()};t.k=function(){r.r.visible=false;r.n.visible=true;n[r.a].visible=true;mStage.update()};t.int=function(){var i,s,o,u,f,l,c,h,p,d,v;c=new IComp({src:"../../../common/images/btn_bar.png",x:sWidth-20,y:1});t.addChild(c);$(e).children().each(function(e,r){v=$(this).find("element")[0];if(v){h=$(this).attr("type")?$(this).attr("type"):"SINGLE";p=getCJSElement(h,r,"commonMediaText");p.visible=false;t.addChild(p);mStage.update();n[n.length]=p}else{d={};$.each(this.attributes,function(e,t){d[t.name]=t.value});t.addChild(getCJSElement($(this).attr("type"),d))}});for(var m=0;m<$(e).find("slide").length;m++){u=m<10?"0"+(m+1):m;o="../../../common/images/btn"+u+".png";s="../../../common/images/btn"+u+"_sel.png";i=new createjs.Container;f=new IComp({src:o,x:0,y:0});i.addChild(f);i.n=f;f=new IComp({src:s,x:0,y:0});i.addChild(f);i.r=f;l=new createjs.Shape;l.graphics.beginFill().drawRect(0,0,26,36);i.addChild(l);i.a=m;i.onMouseOver=t.f;i.onMouseOut=t.g;i.onClick=t.h;t.addChild(i);i.x=sWidth-18;i.y=3+m*36;if(m==0)r=i}t.k()};loadImages(e,t.int)}).prototype=new createjs.Container;(slide=function(e,t){this.initialize();var n=this;n.int=function(){$(e).find("element").each(function(e,r){var i={};$.each(this.attributes,function(e,t){i[t.name]=t.value});n.addChild(getCJSElement($(this).attr("type"),i,t))});mStage.update()};loadImages(e,n.int)}).prototype=new createjs.Container;(Button=function(e){this.initialize();var t=this}).prototype=new createjs.Container;(TBComp=function(e){this.initialize();var t=this;var n,r,i,s,o;w=e.width?parseFloat(e.width):50;h=e.height?parseFloat(e.height):50;e.divId=e.divId?e.divId:"textBoxDiv";$("#mediaContainer").append('<div id="'+e.divId+'"></div>');s=document.createElement("canvas");s.width=w+25;s.height=h+20;s.id="textBoxCanvas";s.style.cssText="position:absolute;left:0px;top:0px;";$("#"+e.divId).append(s);var u=new createjs.DOMElement(s);t.x=e.x?parseFloat(e.x):0;t.y=e.y?parseFloat(e.y):0;t.y=t.y-11;t.addChild(u);pStage=new createjs.Stage(s);var o=new createjs.Container;o.x=15;o.y=10;pStage.addChild(o);n=new createjs.Shape;n.graphics.beginFill("#C1ABD1").drawRoundRect(0,0,w,h,4);n.shadow=new createjs.Shadow("#666263",0,3,7);o.addChild(n);n=new createjs.Shape;n.graphics.beginFill("#462559").drawRect(2,0,w-4,2);n.y=5;o.addChild(n);i=4;h=h-4;if(e.titleId){r=new TComp({compId:e.titleId,x:1,y:13,width:w-30,div:e.divId});t.addChild(r);i=$("#"+e.titleId).height()+4;n.y=i;h=h-i+4}n=new createjs.Shape;n.graphics.beginFill("#fff").drawRect(3,5,w-7,h-8);n.y=i?i:0;o.addChild(n);if(e.bodyId){e.style="overflow:auto !important; height:"+(h-9)+"px;";r=new TComp({compId:e.bodyId,x:1.5,y:n.y+16,width:w-9,style:e.style,div:e.divId});t.addChild(r)}e.subType=e.subType?e.subType:"ROLLOVER";if(e.subType=="CLOSABLE"){if(createjs.Touch.isSupported())createjs.Touch.enable(pStage);pStage.enableMouseOver();n=new IComp({src:"../../../common/images/closeBtn.jpg",x:w-18,y:3});n.scaleX=n.scaleY=.9;n.onClick=function(n){if(e.animated&&e.animated=="1"){$("#"+e.divId).hide(2e3)}else{t.visible=false}if(t.getStage())t.getStage().update()};o.addChild(n)}e.visible=e.visible?e.visible:"1";if(e.visible=="0")t.visible=false;pStage.update()}).prototype=new createjs.Container;(BComp=function(e){this.initialize();var t=this;var n,r;var i,s,o,u;n=e.width?parseFloat(e.width):50;r=e.height?parseFloat(e.height):50;e.align=e.align?e.align:"left";if(e.tailPosition=="2"||e.tailPosition=="3"||e.tailPosition=="4"||e.tailPosition=="8"||e.tailPosition=="8"||e.tailPosition=="10")n=n-18;e.w=n;u=new TComp({compId:e.compId,x:-10,y:4,size:10,div:"commonMediaText",width:n-8,height:r-8,align:e.align,bgColor:"#cce9e7",borderColor:"#67bdbc",corner:4,border:3,expand:"down"});n=$("#"+e.compId).width();r=$("#"+e.compId).height()+10;i=new createjs.Shape;i.graphics.beginFill("#000").drawRoundRect(0,1,e.w-8,r+4,4);i.shadow=new createjs.Shadow("#666263",0,3,7);t.addChild(i,u);n=n<30?30:n;r=r<30?30:r;e.val=e.tailFlip&&e.tailFlip=="1"?15:0;s=new createjs.Shape;s.graphics.beginFill("#67bdbc");s.graphics.lineTo(0,0).lineTo(15,0).lineTo(e.val,-20).lineTo(0,0);s.graphics.endFill();t.addChild(s);e.x=e.x?parseFloat(e.x):0;e.y=e.y?parseFloat(e.y):0;switch(e.tailPosition){case"1":e.y=e.y+19;s.y=1;s.x=n-27;break;case"2":s.rotation=90;s.x=n+5;s.y=12;break;case"3":s.rotation=90;s.x=n+5;s.y=(r-15)/2;break;case"4":s.rotation=90;s.x=n+5;s.y=r-20;break;case"5":s.rotation=180;s.x=n-10;s.y=r+5;break;case"6":s.rotation=180;s.x=(n+25)/2;s.y=r+5;break;case"7":s.rotation=180;s.x=30;s.y=r+5;break;case"8":s.rotation=270;u.x=u.x+5;s.x=s.x;s.y=r-5;break;case"9":s.rotation=270;u.x=u.x+5;s.x=s.x;s.y=(r+15)/2;break;case"10":s.rotation=270;u.x=u.x+5;s.x=s.x;s.y=28;break;case"11":s.x=0;s.y=1;e.y=e.y+19;break;case"12":e.y=e.y+19;s.x=(n-22)/2;s.y=1;break}t.x=e.x;t.y=e.y}).prototype=new createjs.Container;(Router=function(t){this.initialize();var n=this;var r;t.width=t.width?parseFloat(t.width)*2-60:50;t.height=t.height?parseFloat(t.height)*2-60:50;var i=new Image;i.onload=function(e){n.init(e)};i.src="../../../common/images/Router.png";n.init=function(r){var i,s,u;s=new createjs.Container;u=new createjs.Bitmap(r.target);bd=new createjs.Bitmap(r.target);bl=new createjs.Bitmap(r.target);br=new createjs.Bitmap(r.target);i=new createjs.Shape;i.graphics.beginFill("#F2F2F2").drawRect(20,20,t.width+40,t.height+40);s.addChild(i);i=new createjs.Shape;i.graphics.beginBitmapFill(r.target,"no-repeat").drawRect(0,0,40,40);s.addChild(i);u.sourceRect=new createjs.Rectangle(40,0,40,40);u.x=39.1;u.scaleX=t.width/40;s.addChild(u);i=new createjs.Shape;i.graphics.beginBitmapFill(r.target,"no-repeat").drawRect(160,0,40,40);i.x=t.width-122;s.addChild(i);i=new createjs.Shape;i.graphics.beginBitmapFill(r.target,"no-repeat").drawRect(0,80,40,40);i.y=-41.5+t.height;s.addChild(i);bd.sourceRect=new createjs.Rectangle(40,80,40,40);bd.x=39.1;bd.y=38.5+t.height;bd.scaleX=t.width/40;s.addChild(bd);i=new createjs.Shape;i.graphics.beginBitmapFill(r.target,"no-repeat").drawRect(160,80,40,40);i.x=t.width-122;i.y=-41.5+t.height;s.addChild(i);bl.sourceRect=new createjs.Rectangle(0,40,40,40);bl.y=39.1;bl.scaleY=t.height/40;s.addChild(bl);br.sourceRect=new createjs.Rectangle(160,40,40,40);br.x=t.width+38;br.y=39.1;br.scaleY=t.height/40;s.addChild(br);s.scaleX=s.scaleY=.5;s.x=-5;n.addChild(s);t.x=t.x?parseFloat(t.x):0;t.y=t.y?parseFloat(t.y):0;n.x=t.x;n.y=t.y-5;if(t.textId){t.style=t.style?t.style:"";t.size=t.size?t.size:11;t.text=t.text?t.text:$(cx).find("text#"+t.textId).text();t.style="overflow:auto !important;height:"+(t.height/2+11)+"px";e=new TComp({textId:t.textId,text:t.text,x:6,y:14,div:"commonMediaText",width:t.width/2+11,align:t.align,style:t.style});n.addChild(e)}mStage.update()}}).prototype=new createjs.Container;(AComp=function(e){this.initialize();var t=this;var n,r,i;e.length=e.length?e.length:10;e.color=e.color?e.color:"#000";e.thickness=e.thickness?e.thickness:2;r=e.thickness?15:30;i=e.thickness?5:10;i=i+.5;n=new createjs.Shape;n.graphics.setStrokeStyle(e.thickness/4);n.graphics.beginStroke(e.color);n.graphics.beginFill(e.color);n.graphics.moveTo(0,0);n.graphics.lineTo(0,0);n.graphics.lineTo(r,i);n.graphics.lineTo(r/1.3,0);n.graphics.lineTo(r,-i);n.graphics.lineTo(-1.5,0);n.graphics.setStrokeStyle(e.thickness*1.5);n.graphics.moveTo(r/2,0);n.graphics.lineTo(e.length,0);n.graphics.endFill();t.addChild(n);t.x=e.x?e.x:0;t.y=e.y?e.y:0}).prototype=new createjs.Container;(IComp=function(e){this.initialize();var t=this;var n,r,i,s;n=new Image;n.onload=function(e){t.ol(e)};n.src=e.src;t.ol=function(n){e.width=e.width?e.width:n.target.width;e.height=e.height?e.height:n.target.height;e.r=Math.min(e.width/n.target.width,e.height/n.target.height);e.subType=e.subType?e.subType:"none";i=n.target.width*e.r;s=n.target.height*e.r;r=new createjs.Bitmap(n.target);r.scaleX=r.scaleY=e.r;t.addChild(r);switch(e.subType){case"STD":this.std();break;case"HTML":t.removeChild(r);break;case"HOTSPOT":break}if(e.x)t.x=e.x;if(e.y)t.y=e.y;if(t.getStage())t.getStage().update()};t.std=function(){var e=new createjs.Shape;var n=new createjs.Shape;e.graphics.beginFill("rgba(0,0,0,1)").drawRoundRect(0,0,i,s,8);e.shadow=new createjs.Shadow("#000000",3,3,10);e.x=e.y=.5;e.scaleX=e.scaleY=.99;t.addChild(e);t.swapChildren(r,e);n.graphics.beginFill().drawRoundRect(0,0,i,s,8);t.addChild(n);r.mask=n}}).prototype=new createjs.Container;(TComp=function(e){this.initialize();if(!e){alert('Please define Text object like \n {x:10,y:10,text:"Sample Text",compId:"ID_txt"}');return}var t,n,r,i;var s=this;e.color=e.color?e.color:"#393536";e.size=e.size?e.size:11;e.align=e.align?e.align:"left";e.width=e.width?parseFloat(e.width):"auto";e.expand=e.expand?e.expand:"right";e.text=e.text?e.text:$(mx).find("component#"+e.compId).text();e.style=e.style?e.style:"";e.div=e.div?e.div:"mediaContainer";e.subType=e.subType?e.subType:"LABEL";if(e.subType=="TITLE"){e.align="center";e.size=12;e.x=2;e.y=1;e.expand="down";if($($(cx).find("slide")[0]).attr("type")=="MBAR"){e.width=sWidth-20}else{e.width=sWidth}}e.expand=e.subType=="TABLE"?"undefined":e.expand;i=e.width=="auto"?"auto":e.width+"px";i=e.expand=="left+right"?"auto":e.width+"px";t=document.createElement("div");t.style.cssText="position:absolute;top:0px;left:0px;width:"+i+";overflow:auto;text-align:"+e.align+";font-size:"+e.size+"px;color:"+e.color+";"+e.style+";visibility:hidden;word-wrap:break-word;-moz-user-select: none;-webkit-user-select: none;cursor: default;overflow:hidden;";if(e.compId)t.id=e.compId;if(e.textId){e.expand="undefined";e.text=e.text?e.text:$(cx).find("text#"+e.textId).text();t.id=e.textId}t.innerHTML=e.text;$("#"+e.div).append(t);var o=new createjs.DOMElement(t);n=$(t).height();r=$(t).width();e.x=e.x?parseFloat(e.x):0;e.y=e.y?parseFloat(e.y):0;if(e.bgColor||e.borderColor){e.bgColor=e.bgColor?e.bgColor:"";e.corner=e.corner?parseInt(e.corner):0;e.border=e.border?parseInt(e.border):1;e.borderColor=e.borderColor?e.borderColor:"";var u=new createjs.Shape;u.graphics.setStrokeStyle(e.border);u.graphics.beginStroke(e.borderColor);u.graphics.beginFill(e.bgColor).drawRoundRect(0,0,r+10,n+15,e.corner);u.x=-20;u.y=-7.5;e.x=e.x+8;e.y=e.expand=="up"?e.y-10:e.y+5;s.addChild(u)}switch(e.expand){case"up+down":s.x=e.x+18;s.y=e.y-n/2+10;break;case"down":s.x=e.x+18;s.y=e.y;break;case"up":s.x=e.x+18;s.y=e.y-n+18;break;case"left":s.x=e.x+18;s.y=e.y;break;case"right":s.x=e.x+18;s.y=e.y;break;case"left+right":if(r>e.width){s.x=e.x-(r-e.width)/2+18}else{s.x=e.x+(e.width-r)/2+18}s.y=e.y;break;default:s.x=e.x+18;s.y=e.y;break}s.addChild(o);if(e.rotation)s.rotation=e.rotation}).prototype=new createjs.Container